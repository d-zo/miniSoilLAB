<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module miniSoilLAB.xlshilfen</title>
<style type="text/css">
body {
    background-color: #f0f0f8;
}

table.heading tr {
    background-color: #7799ee;
}

.decor {
    color: #ffffff;
}

.title-decor {
    background-color: #ffc8d8;
    color: #000000;
}

.pkg-content-decor {
    background-color: #aa55cc;
}

.index-decor {
    background-color: #ee77aa;
}

.functions-decor {
    background-color: #eeaa77;
}

.data-decor {
    background-color: #55aa55;
}

.author-decor {
    background-color: #7799ee;
}

.credits-decor {
    background-color: #7799ee;
}

.error-decor {
    background-color: #bb0000;
}

.grey {
    color: #909090;
}

.white {
    color: #ffffff;
}

.repr {
    color: #c040c0;
}

table.heading tr td.title {
    vertical-align: bottom;
}

table.heading tr td.extra {
    vertical-align: bottom;
    text-align: right;
}

.heading-text {
    font-family: helvetica, arial;
}

.bigsection {
    font-size: larger;
}

.title {
    font-size: x-large;
}

.code {
    font-family: monospace;
}

table {
    width: 100%;
    border-spacing : 0;
    border-collapse : collapse;
    border: 0;
}

td {
    padding: 2;
}

td.section-title {
    vertical-align: bottom;
}

td.multicolumn {
    width: 25%;
    vertical-align: bottom;
}

td.singlecolumn {
    width: 100%;
}
</style>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title"><a href="miniSoilLAB.html" class="white">miniSoilLAB</a>.xlshilfen</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:/home/seriousjr/Files/WWW/github/miniSoilLAB/utils/temp_work_dir/miniSoilLAB/xlshilfen.py">/home/seriousjr/Files/WWW/github/miniSoilLAB/utils/temp_work_dir/miniSoilLAB/xlshilfen.py</a></td></tr></table>
    <p><span class="code">xlshilfen.py&nbsp;&nbsp;&nbsp;v0.3&nbsp;(2019-11)</span></p>
<p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>

<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-EinzelEintragEinlesen"><strong>EinzelEintragEinlesen</strong></a>(workbook, tabellenname, zeile, spalte, name, tabellentyp, inhalt, warnen=True)</dt><dd><span class="code">Lese&nbsp;aus&nbsp;dem&nbsp;uebergebenen&nbsp;workbook&nbsp;einer&nbsp;eingelesenen&nbsp;Excel-Tabelle&nbsp;Daten&nbsp;aus&nbsp;einer&nbsp;Zelle&nbsp;aus.<br>
Fuer&nbsp;diese&nbsp;Zelle&nbsp;muss&nbsp;ueber&nbsp;tabellenname,&nbsp;zeile&nbsp;und&nbsp;spalte&nbsp;die&nbsp;exakte&nbsp;Position&nbsp;angegeben&nbsp;werden.<br>
Zusaetzlich&nbsp;ist&nbsp;der&nbsp;ueber&nbsp;den&nbsp;tabellentyp&nbsp;(xls/xlsx)&nbsp;anzugeben,&nbsp;ob&nbsp;die&nbsp;Datei&nbsp;und&nbsp;deren&nbsp;Daten<br>
nach&nbsp;den&nbsp;alten&nbsp;Dateistandards&nbsp;oder&nbsp;den&nbsp;XML-basierten&nbsp;Dateistandards&nbsp;zu&nbsp;interpretieren&nbsp;sind.<br>
Falls&nbsp;inhalt='zahl'&nbsp;wird&nbsp;der&nbsp;Zelleninhalt&nbsp;zu&nbsp;einem&nbsp;float&nbsp;umgewandelt&nbsp;und&nbsp;zurueckgegeben,<br>
andernfalls&nbsp;als&nbsp;String.&nbsp;Falls&nbsp;die&nbsp;Zelle&nbsp;nicht&nbsp;gefunden&nbsp;werden&nbsp;konnte,&nbsp;wird&nbsp;None&nbsp;zurueckgegeben.</span></dd></dl>
 <dl><dt><a name="-EinzelEintragHinzufuegen"><strong>EinzelEintragHinzufuegen</strong></a>(datenbank, workbook, tabellenname, zeile, spalte, name, tabellentyp, inhalt, grenzen=None)</dt><dd><span class="code">Lese&nbsp;aus&nbsp;dem&nbsp;uebergebenen&nbsp;workbook&nbsp;einer&nbsp;eingelesenen&nbsp;Excel-Tabelle&nbsp;Daten&nbsp;aus&nbsp;einer&nbsp;Zelle&nbsp;aus<br>
und&nbsp;speichere&nbsp;den&nbsp;Wert&nbsp;in&nbsp;datenbank.&nbsp;Fuer&nbsp;inhalt&nbsp;=&nbsp;'zahl'&nbsp;kann&nbsp;auch&nbsp;eine&nbsp;Ueberpruefung&nbsp;der<br>
grenzen&nbsp;erfolgen&nbsp;(sofern&nbsp;diese&nbsp;nicht&nbsp;None&nbsp;sind).&nbsp;Ruft&nbsp;intern&nbsp;<a href="#-EinzelEintragEinlesen">EinzelEintragEinlesen</a>()&nbsp;auf&nbsp;und<br>
speichert&nbsp;den&nbsp;(erfolgreich)&nbsp;eingelesenen&nbsp;Zelleninhalt&nbsp;darin&nbsp;mit&nbsp;dem&nbsp;Schluessel&nbsp;name.</span></dd></dl>
 <dl><dt><a name="-GelesenenEintragHinzufuegen"><strong>GelesenenEintragHinzufuegen</strong></a>(datenbank, name, daten, grenzen=None)</dt><dd><span class="code">Speichere&nbsp;bereits&nbsp;eingelesene&nbsp;Inhalte&nbsp;aus&nbsp;daten&nbsp;in&nbsp;datenbank&nbsp;(unter&nbsp;dem&nbsp;Schluessel&nbsp;name).<br>
Fuer&nbsp;Zahlen&nbsp;kann&nbsp;auch&nbsp;eine&nbsp;Ueberpruefung&nbsp;der&nbsp;grenzen&nbsp;erfolgen&nbsp;(sofern&nbsp;diese&nbsp;nicht&nbsp;None&nbsp;sind).<br>
Nur&nbsp;erfolgreich&nbsp;gepruefte&nbsp;daten&nbsp;werden&nbsp;gespeichert.</span></dd></dl>
 <dl><dt><a name="-LeseXLSDaten"><strong>LeseXLSDaten</strong></a>(dateiname, verarbeitet=True, ignoriere=['rohdaten'])</dt><dd><span class="code">Lese&nbsp;eine&nbsp;Excel-Tabelle&nbsp;namens&nbsp;dateiname&nbsp;ein.&nbsp;Abhaengig&nbsp;von&nbsp;den&nbsp;verfuegbaren&nbsp;Vorlagen&nbsp;wird<br>
unterschieden,&nbsp;welche&nbsp;Art&nbsp;von&nbsp;Versuchsdaten&nbsp;in&nbsp;der&nbsp;Datei&nbsp;gespeichert&nbsp;sind&nbsp;und&nbsp;versucht,&nbsp;ebenjene<br>
einzulesen.&nbsp;Gibt&nbsp;bei&nbsp;Erfolg&nbsp;eine&nbsp;Datenstruktur&nbsp;mit&nbsp;den&nbsp;eingelesenen&nbsp;Daten&nbsp;unter&nbsp;dem&nbsp;Schluessel<br>
Versuchsart&nbsp;zurueck&nbsp;(bspw.&nbsp;als&nbsp;LoDi&nbsp;fuer&nbsp;eine&nbsp;Tabelle&nbsp;zur&nbsp;Bestimmung&nbsp;der&nbsp;lockersten/dichtesten<br>
Lagerung&nbsp;oder&nbsp;Triax-D-dicht&nbsp;fuer&nbsp;einen&nbsp;drainierten&nbsp;Triaxialversuch&nbsp;mit&nbsp;dicht&nbsp;im&nbsp;Dateinamen).<br>
Wenn&nbsp;die&nbsp;Datei&nbsp;ignoriert&nbsp;wird&nbsp;oder&nbsp;nicht&nbsp;gefunden/geparst&nbsp;werden&nbsp;kann,&nbsp;wird&nbsp;eine&nbsp;leere&nbsp;Struktur<br>
zurueckgegeben&nbsp;(eine&nbsp;Datei&nbsp;wird&nbsp;ignoriert,&nbsp;wenn&nbsp;der&nbsp;Name&nbsp;(mindestens)&nbsp;ein&nbsp;Element&nbsp;aus&nbsp;der&nbsp;Liste<br>
ignoriere&nbsp;enthaelt).</span></dd></dl>
 <dl><dt><a name="-ParseXLSDaten"><strong>ParseXLSDaten</strong></a>(daten, workbook, tabellentyp, tabellenname, vorlage, verarbeitet)</dt><dd><span class="code">Ein&nbsp;(ggfs.&nbsp;verschachteltes)&nbsp;dict&nbsp;wird&nbsp;als&nbsp;vorlage&nbsp;uebergeben&nbsp;und&nbsp;abgearbeitet.&nbsp;Fuer&nbsp;jeden<br>
der&nbsp;Eintraege&nbsp;wird&nbsp;eine&nbsp;Struktur&nbsp;in&nbsp;daten&nbsp;angelegt&nbsp;und&nbsp;mit&nbsp;Werten&nbsp;aus&nbsp;der&nbsp;Tabelle&nbsp;tabellenname<br>
eines&nbsp;workbook&nbsp;des&nbsp;Typs&nbsp;tabellentyp&nbsp;aufgefuellt.<br>
&nbsp;<br>
Fuer&nbsp;alle&nbsp;Schluessel&nbsp;in&nbsp;vorlage,&nbsp;die&nbsp;nicht&nbsp;in&nbsp;eckigen&nbsp;Klammern&nbsp;stehen,&nbsp;wird&nbsp;ein&nbsp;gleicher<br>
Schluessel&nbsp;mit&nbsp;der&nbsp;gleichen&nbsp;Struktur&nbsp;in&nbsp;daten&nbsp;angelegt.&nbsp;In&nbsp;den&nbsp;Werten&nbsp;eines&nbsp;Schluessels&nbsp;wird<br>
ein&nbsp;Bereich&nbsp;an&nbsp;Zellen&nbsp;in&nbsp;einer&nbsp;Liste&nbsp;erwartet,&nbsp;die&nbsp;fuer&nbsp;diesen&nbsp;Schluessel&nbsp;eingelesen&nbsp;werden&nbsp;sollen<br>
(bspw.&nbsp;["G14"]&nbsp;oder&nbsp;["A7:A20"]).&nbsp;Falls&nbsp;die&nbsp;Zellen&nbsp;nicht&nbsp;als&nbsp;Text,&nbsp;sondern&nbsp;als&nbsp;Zahlenwerte<br>
eingelesen&nbsp;werden&nbsp;sollen,&nbsp;muss&nbsp;in&nbsp;einer&nbsp;Liste&nbsp;Zellenbereich&nbsp;und&nbsp;Wertbereich&nbsp;angegeben&nbsp;werden,<br>
(bspw.&nbsp;([["G14"],&nbsp;[0.0,&nbsp;100.0]]).<br>
&nbsp;<br>
Wenn&nbsp;ein&nbsp;Schluessel&nbsp;in&nbsp;vorlage&nbsp;in&nbsp;eckigen&nbsp;Klammern&nbsp;steht,&nbsp;werden&nbsp;alle&nbsp;Eintraege&nbsp;in&nbsp;den&nbsp;Werten<br>
als&nbsp;Gruppe&nbsp;eingelesen.&nbsp;Das&nbsp;fuehrt&nbsp;dazu,&nbsp;dass&nbsp;bei&nbsp;Bereichen&nbsp;einzelne&nbsp;Werte&nbsp;von&nbsp;allen<br>
Gruppenmitgliedern&nbsp;uebersprungen&nbsp;werden,&nbsp;wenn&nbsp;fuer&nbsp;mindestens&nbsp;ein&nbsp;Gruppenmitglied&nbsp;kein&nbsp;gueltiger<br>
Wert&nbsp;existiert.&nbsp;Die&nbsp;Struktur&nbsp;mit&nbsp;dem&nbsp;Namen&nbsp;in&nbsp;eckigen&nbsp;Klammern&nbsp;wird&nbsp;nicht&nbsp;angelegt,&nbsp;sondern&nbsp;alle<br>
Gruppenmitglieder&nbsp;werden&nbsp;in&nbsp;der&nbsp;Elternstruktur&nbsp;gespeichert.</span></dd></dl>
 <dl><dt><a name="-TabellenDimension"><strong>TabellenDimension</strong></a>(workbook, tabellenname, tabellentyp)</dt><dd><span class="code">Lese&nbsp;aus&nbsp;dem&nbsp;uebergebenen&nbsp;workbook&nbsp;einer&nbsp;eingelesenen&nbsp;Excel-Tabelle&nbsp;aus,&nbsp;wieviele&nbsp;Zeilen<br>
und&nbsp;Spalten&nbsp;in&nbsp;der&nbsp;Tabelle&nbsp;namens&nbsp;tabellenname&nbsp;maximal&nbsp;verwendet&nbsp;sind.&nbsp;Zusaetzlich&nbsp;ist&nbsp;der&nbsp;ueber<br>
den&nbsp;tabellentyp&nbsp;(xls/xlsx)&nbsp;anzugeben,&nbsp;ob&nbsp;die&nbsp;Datei&nbsp;und&nbsp;deren&nbsp;Daten&nbsp;nach&nbsp;den&nbsp;alten&nbsp;Dateistandards<br>
oder&nbsp;den&nbsp;XML-basierten&nbsp;Dateistandards&nbsp;zu&nbsp;interpretieren&nbsp;sind.&nbsp;Gibt&nbsp;[zeilen,&nbsp;spalten]&nbsp;zurueck<br>
oder&nbsp;[None,&nbsp;None],&nbsp;falls&nbsp;die&nbsp;Tabelle&nbsp;nicht&nbsp;gefunden&nbsp;werden&nbsp;konnte.</span></dd></dl>
 <dl><dt><a name="-TabellenseiteAusgeben"><strong>TabellenseiteAusgeben</strong></a>(workbook, tabellenname, tabellentyp)</dt><dd><span class="code">Gibt&nbsp;aus&nbsp;dem&nbsp;uebergebenen&nbsp;workbook&nbsp;einer&nbsp;eingelesenen&nbsp;Excel-Tabelle&nbsp;die&nbsp;Tabellenseite&nbsp;mit&nbsp;dem<br>
Namen&nbsp;tabellenname&nbsp;zurueck.&nbsp;Dazu&nbsp;ist&nbsp;der&nbsp;ueber&nbsp;den&nbsp;tabellentyp&nbsp;(xls/xlsx)&nbsp;anzugeben,&nbsp;ob&nbsp;die&nbsp;Datei<br>
und&nbsp;deren&nbsp;Daten&nbsp;nach&nbsp;den&nbsp;alten&nbsp;Dateistandards&nbsp;oder&nbsp;den&nbsp;XML-basierten&nbsp;Dateistandards&nbsp;zu<br>
interpretieren&nbsp;sind.&nbsp;Falls&nbsp;die&nbsp;Tabellenseite&nbsp;nicht&nbsp;existiert,&nbsp;wird&nbsp;None&nbsp;zurueckgegeben.</span></dd></dl>
 <dl><dt><a name="-VorhandeneTabellenseiten"><strong>VorhandeneTabellenseiten</strong></a>(workbook, tabellentyp)</dt><dd><span class="code">Lese&nbsp;aus&nbsp;dem&nbsp;uebergebenen&nbsp;workbook&nbsp;einer&nbsp;eingelesenen&nbsp;Excel-Tabelle&nbsp;die&nbsp;Liste&nbsp;an&nbsp;vorhandenen<br>
Tabellenseiten&nbsp;aus.&nbsp;Gibt&nbsp;diese&nbsp;Liste&nbsp;zurueck.</span></dd></dl>
 <dl><dt><a name="-ZeileUndSpalteAusZellenbezeichnung"><strong>ZeileUndSpalteAusZellenbezeichnung</strong></a>(zellenname)</dt><dd><span class="code">Ermitttle&nbsp;die&nbsp;Zeile&nbsp;und&nbsp;Spalte&nbsp;einer&nbsp;Zelle&nbsp;aus&nbsp;dem&nbsp;uebergebenem&nbsp;zellenname.&nbsp;Der&nbsp;Zellenname<br>
besteht&nbsp;aus&nbsp;einem&nbsp;oder&nbsp;mehreren&nbsp;Buchstaben&nbsp;fuer&nbsp;die&nbsp;Spalte&nbsp;und&nbsp;einer&nbsp;Zahl&nbsp;(ggfs.&nbsp;mit&nbsp;mehreren<br>
Stellen)&nbsp;fuer&nbsp;die&nbsp;Zeile.&nbsp;Gibt&nbsp;[zeile,&nbsp;spalte]&nbsp;zurueck.</span></dd></dl>
 <dl><dt><a name="-ZellenbereichKoordinaten"><strong>ZellenbereichKoordinaten</strong></a>(workbook, tabellentyp, tabellenname, bereich)</dt><dd><span class="code">Ermittelt,&nbsp;ob&nbsp;der&nbsp;uebergebene&nbsp;bereich&nbsp;(bspw.&nbsp;"D14&nbsp;oder&nbsp;"G5:R5")&nbsp;fuer&nbsp;die&nbsp;Tabellenseite<br>
tabellenname&nbsp;im&nbsp;workbook&nbsp;des&nbsp;tabellentyps&nbsp;zulaessig&nbsp;ist,&nbsp;oder&nbsp;nicht.&nbsp;Wenn&nbsp;der&nbsp;Bereich&nbsp;zulaessig<br>
ist,&nbsp;werden&nbsp;die&nbsp;umgewandelten&nbsp;Koordinaten&nbsp;fuer&nbsp;jede&nbsp;Zelle&nbsp;[(zeile,&nbsp;spalte),&nbsp;(zeile,&nbsp;spalte),&nbsp;...]<br>
zurueckgegeben,&nbsp;sonst&nbsp;[(None,&nbsp;None)].</span></dd></dl>
</td></tr></table>
</body></html>